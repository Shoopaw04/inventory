<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Login</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:#f5f7fb; display:flex; align-items:center; justify-content:center; height:100vh; }
    .card { background:#fff; padding:24px; border-radius:10px; box-shadow:0 6px 24px rgba(0,0,0,.08); width: 360px; }
    h1 { font-size:18px; margin:0 0 12px; }
    .row { margin-bottom:10px; }
    label { display:block; font-size:12px; color:#555; margin-bottom:6px; }
    input { width:100%; padding:10px; border:1px solid #ddd; border-radius:6px; }
    button { width:100%; padding:10px; border:none; border-radius:6px; background:#2a5298; color:#fff; font-weight:600; cursor:pointer; }
    .error { color:#b00020; font-size:12px; margin-top:8px; display:none; }
  </style>
  <script src="../js/api.js"></script>
  <script>
    async function doLogin(e){
      e.preventDefault();
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;
      const err = document.getElementById('err');
      err.style.display = 'none';
      try {
        const json = await postJSON('login.php', {username, password});
        if (!json.success) { err.textContent = json.error || 'Login failed'; err.style.display = 'block'; return; }
        const role = (json.data && json.data.role_name) ? json.data.role_name.toLowerCase() : '';
        if (role === 'cashier') {
          location.href = './pos.html';
        } else if (role === 'inventory clerk' || role === 'inventory staff') {
          location.href = './stockin_inventory.html';
        } else {
          location.href = './dashboard.html';
        }
      } catch(ex){ err.textContent = 'Network error'; err.style.display = 'block'; }
    }
  </script>
</head>
<body>
  <form class="card" onsubmit="doLogin(event)">
    <h1>Sign in</h1>
    <div class="row">
      <label>Username</label>
      <input id="username" autocomplete="username" />
    </div>
    <div class="row">
      <label>Password</label>
      <input id="password" type="password" autocomplete="current-password" />
    </div>
    <button type="submit">Login</button>
    <div id="err" class="error"></div>
  </form>
</body>
</html>


